# Solution Generation Scripts

Scripts for generating and managing solution content for FocusApp's bundled `Solutions.json`.

## Overview

| Script | Purpose |
|--------|---------|
| `generate_solution.swift` | Generate blank solution templates with TODO placeholders |
| `solution_generator.swift` | AI-powered solution generator (OpenAI or stub files) |
| `fetch_problems.swift` | Fetch problem metadata from LeetCode to build the manifest |

## Prerequisites

- Swift 5.0+ (included with Xcode)
- `problem-manifest.json` in `FocusApp/Resources/` (generated by `fetch_problems.swift`)
- For AI generation: `OPENAI_API_KEY` environment variable

## Quick Start

```bash
# Make scripts executable
chmod +x Scripts/*.swift

# Run from the project root directory
cd /path/to/FocusApp
```

---

## generate_solution.swift

Creates solution templates with TODO placeholders for manual completion.

### Commands

```bash
# Generate template for a single problem
./Scripts/generate_solution.swift template <slug>

# Generate templates for all problems in a topic
./Scripts/generate_solution.swift batch <topic>

# List all available topics
./Scripts/generate_solution.swift list-topics

# List problems (optionally filter by topic)
./Scripts/generate_solution.swift list-problems
./Scripts/generate_solution.swift list-problems --topic "Array"
```

### Examples

```bash
# Generate template for Two Sum
./Scripts/generate_solution.swift template two-sum

# Generate templates for all Linked List problems
./Scripts/generate_solution.swift batch "Linked List"
```

### Output

- Single template: Prints JSON to stdout
- Batch: Creates `<topic>-solutions-template.json` in current directory

---

## solution_generator.swift

AI-powered solution generator that produces complete solutions.

### Commands

```bash
./Scripts/solution_generator.swift generate [options]
```

### Options

| Option | Description |
|--------|-------------|
| `--slug <slug>` | Generate for a specific problem slug (repeatable) |
| `--topic <topic>` | Generate for all problems with a topic |
| `--output <path>` | Output path (default: `FocusApp/Resources/Solutions.json`) |
| `--provider <stub\|openai>` | AI provider to use |
| `--stub-dir <path>` | Directory containing stub JSON files |
| `--replace` | Replace existing solutions if slug already exists |

### Provider: OpenAI

Uses OpenAI's API to generate solutions.

```bash
# Set API key
export OPENAI_API_KEY="sk-..."

# Optional: specify model (default: gpt-4.1-mini)
export OPENAI_MODEL="gpt-4"

# Generate solution
./Scripts/solution_generator.swift generate --slug two-sum --provider openai
```

### Provider: Stub

Uses pre-written JSON files for offline/testing scenarios.

```bash
# Create stub directory with JSON files named by slug
mkdir stubs
echo '{"summary": "...", "approaches": [...]}' > stubs/two-sum.json

# Generate from stubs
./Scripts/solution_generator.swift generate --slug two-sum --provider stub --stub-dir ./stubs
```

### Stub File Format

```json
{
  "summary": "Brief problem summary and key insight",
  "approaches": [
    {
      "name": "Brute Force",
      "intuition": "Why this approach works",
      "approach": "Step-by-step algorithm",
      "explanation": "Detailed explanation",
      "code": "func solution() { ... }",
      "complexity": {
        "time": "O(n^2)",
        "space": "O(1)",
        "timeExplanation": "Nested loops",
        "spaceExplanation": "Constant extra space"
      },
      "testCases": [
        {
          "input": "[2,7,11,15], target = 9",
          "expectedOutput": "[0,1]",
          "explanation": "nums[0] + nums[1] = 9"
        }
      ]
    },
    {
      "name": "Hash Map",
      "intuition": "...",
      "approach": "...",
      "explanation": "...",
      "code": "...",
      "complexity": { ... },
      "testCases": [ ... ]
    }
  ],
  "relatedProblems": ["three-sum", "two-sum-ii-input-array-is-sorted"]
}
```

### Examples

```bash
# Generate single solution with OpenAI
./Scripts/solution_generator.swift generate \
  --slug two-sum \
  --provider openai

# Generate multiple solutions
./Scripts/solution_generator.swift generate \
  --slug two-sum \
  --slug reverse-linked-list \
  --provider openai

# Generate all Array problems
./Scripts/solution_generator.swift generate \
  --topic "Array" \
  --provider openai

# Replace existing solution
./Scripts/solution_generator.swift generate \
  --slug two-sum \
  --provider openai \
  --replace
```

---

## Problem Manifest

The scripts require `FocusApp/Resources/problem-manifest.json`:

```json
{
  "version": "1.0.0",
  "generatedAt": "2026-02-06T05:41:15Z",
  "totalProblems": 85,
  "problems": [
    {
      "number": 1,
      "title": "Two Sum",
      "slug": "two-sum",
      "difficulty": "Easy",
      "topics": ["Array", "Hash Table"],
      "acceptanceRate": 56.97
    }
  ]
}
```

Generate/update the manifest:

```bash
./Scripts/fetch_problems.swift
```

---

## Solutions.json Schema

The output `Solutions.json` follows this structure:

```json
{
  "version": "1.0.0",
  "solutions": [
    {
      "id": "uuid",
      "problemSlug": "two-sum",
      "summary": "Problem summary",
      "approaches": [
        {
          "id": "uuid",
          "name": "Approach Name",
          "order": 1,
          "intuition": "Key insight",
          "approach": "Step-by-step algorithm",
          "explanation": "Detailed explanation",
          "code": "Swift code",
          "complexity": {
            "time": "O(n)",
            "space": "O(n)",
            "timeExplanation": "...",
            "spaceExplanation": "..."
          },
          "testCases": [
            {
              "id": "uuid",
              "input": "...",
              "expectedOutput": "...",
              "explanation": "..."
            }
          ]
        }
      ],
      "relatedProblems": ["slug1", "slug2"],
      "lastUpdated": "2026-02-06T12:00:00Z"
    }
  ]
}
```

---

## Workflow

### Adding New Solutions

1. **Check if problem is in manifest**
   ```bash
   ./Scripts/generate_solution.swift list-problems --topic "Array"
   ```

2. **Generate solution** (choose one):
   ```bash
   # AI-generated (requires API key)
   ./Scripts/solution_generator.swift generate --slug problem-slug --provider openai

   # Manual template
   ./Scripts/generate_solution.swift template problem-slug > solution.json
   # Edit solution.json, then merge into Solutions.json
   ```

3. **Verify in app**: Run FocusApp and check the Solution tab

### Updating Existing Solutions

```bash
./Scripts/solution_generator.swift generate \
  --slug problem-slug \
  --provider openai \
  --replace
```

### Batch Generation by Topic

```bash
# Generate all Dynamic Programming solutions
./Scripts/solution_generator.swift generate \
  --topic "Dynamic Programming" \
  --provider openai
```

---

## Validation

The generator validates solutions before writing:

- Summary must not be empty
- At least 2 approaches required (baseline + optimized)
- Each approach must have a name and code
- Existing solutions are preserved unless `--replace` is specified

---

## Troubleshooting

### "Problem not found in manifest"

Run `fetch_problems.swift` to update the manifest, or verify the slug is correct.

### OpenAI errors

- Check `OPENAI_API_KEY` is set
- Verify API quota/billing
- Try a different model via `OPENAI_MODEL`

### JSON parsing errors

The generator extracts JSON from the AI response. If parsing fails:
- Check the model is producing valid JSON
- Use the stub provider for consistent results

---

## File Locations

| File | Path |
|------|------|
| Problem manifest | `FocusApp/Resources/problem-manifest.json` |
| Solutions bundle | `FocusApp/Resources/Solutions.json` |
| Scripts | `Scripts/*.swift` |
